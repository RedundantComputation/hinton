<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Publications - Geoffrey Hinton</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.11.1/font/bootstrap-icons.min.css">
    <style>
        :root {
            --bs-primary: #0d6efd;
            --bg-color: #ffefca;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background-color: var(--bg-color);
        }

        .header {
            border-bottom: 1px solid #dee2e6;
            background: white !important;
        }

        .tag-filter {
            margin-bottom: 1rem;
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
            justify-content: center; /* Center the buttons horizontally */
            align-items: center; /* Center the buttons vertically if needed */
            padding-right: 70px; /* Reserve space so tags don't underlap the fixed scrubber */
            box-sizing: border-box;
            max-width: 100%;
        }
        
        .filter-label {
            font-weight: 600;
            color: #212529;
            margin-right: 0.25rem;
            align-self: center;
        }
        
        .tag-btn {
            padding: 0.5rem 1rem;
            border: 1px solid var(--bs-primary);
            background: white;
            color: var(--bs-primary);
            border-radius: 0.25rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .tag-btn.active,
        .tag-btn:hover {
            background: var(--bs-primary);
            color: white;
        }

        .publications-container {
            position: relative;
            padding-right: 60px; /* Space for scrubber */
        }

        .year-section {
            margin-bottom: 2rem;
            scroll-margin-top: 80px; /* Account for sticky header */
        }

        .year-header {
            position: sticky;
            top: 70px;
            background: rgba(255, 239, 202, 0.95);
            backdrop-filter: blur(10px);
            z-index: 10;
            padding: 0.75rem 0;
            border-bottom: 2px solid var(--bs-primary);
            margin-bottom: 1rem;
        }

        .publication-item {
            background: white;
            border-radius: 0.5rem;
            padding: 1.25rem;
            margin-bottom: 1rem;
            box-shadow: 0 0.125rem 0.25rem rgba(0,0,0,0.075);
            transition: all 0.2s ease;
        }

        .publication-item:hover {
            box-shadow: 0 0.5rem 1rem rgba(0,0,0,0.15);
            transform: translateY(-2px);
        }

        .publication-authors {
            color: #6c757d;
            font-size: 0.9rem;
            margin-bottom: 0.5rem;
            line-height: 1.4;
        }

        .publication-title {
            font-weight: 600;
            color: #212529;
            margin-bottom: 0.5rem;
            line-height: 1.4;
        }

        .publication-venue {
            color: var(--bs-primary);
            font-weight: 500;
            font-size: 0.9rem;
            text-decoration: none;
            transition: all 0.2s ease;
            display: inline-block;
        }

        .publication-venue:hover {
            color: #0a58ca;
            text-decoration: underline;
        }

        /* Year Scrubber */
        .year-scrubber {
            position: fixed;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            width: 40px;
            height: 70vh;
            z-index: 1000;
            user-select: none;
            touch-action: none;
        }

        .scrubber-track {
            position: relative;
            width: 3px;
            height: 100%;
            background: #dee2e6;
            border-radius: 2px;
            margin: 0 auto;
        }

        .scrubber-handle {
            position: absolute;
            width: 20px;
            height: 20px;
            background: var(--bs-primary);
            border-radius: 50%;
            left: 50%;
            transform: translateX(-50%);
            cursor: grab;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
            transition: all 0.1s ease;
        }

        .scrubber-handle:active {
            cursor: grabbing;
            transform: translateX(-50%) scale(1.2);
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        }

        .scrubber-label {
            position: absolute;
            right: 45px;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 0.5rem 0.75rem;
            border-radius: 0.25rem;
            font-size: 0.9rem;
            font-weight: 600;
            white-space: nowrap;
            opacity: 0;
            transition: opacity 0.2s ease;
            pointer-events: none;
        }

        .scrubber-label.active {
            opacity: 1;
        }

        .year-markers {
            position: absolute;
            left: -15px;
            top: 0;
            height: 100%;
            width: 15px;
        }

        .year-marker {
            position: absolute;
            right: 0;
            width: 8px;
            height: 2px;
            background: #6c757d;
            border-radius: 1px;
        }

        .year-marker.major {
            width: 12px;
            background: var(--bs-primary);
        }

        /* Responsive adjustments */
        @media (max-width: 767px) {
            .publications-container {
                padding-right: 50px;
            }
            
            .year-scrubber {
                right: 5px;
                width: 35px;
                height: 60vh;
            }
            
            .scrubber-handle {
                width: 18px;
                height: 18px;
            }
            
            .publication-item {
                padding: 1rem;
            }
            
            .publication-title {
                font-size: 1rem;
            }
        }

        @media (max-width: 480px) {
            .publication-venue {
                font-size: 0.85rem;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header py-3 bg-white sticky-top">
        <div class="container">
            <div class="d-flex justify-content-between align-items-center">
                <h1 class="h4 mb-0">
                    <a href="/hinton/" class="text-decoration-none text-dark">
                        <i class="bi bi-arrow-left me-2"></i>Geoffrey E. Hinton
                    </a>
                </h1>
                <span class="text-muted">Publications</span>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="py-4">
        <div class="container">
            <p class="lead text-center mb-3">This is a full list of Geoffrey Hinton's scientific publications in reverse chronological order. The list can be filtered by one or more topics below.</p>
            <div class="tag-filter">
                <span class="filter-label">Filter By:</span>
                <button class="tag-btn" data-tag="neural networks">Neural Networks</button>
                <button class="tag-btn" data-tag="products of experts">Products of Experts</button>
                <button class="tag-btn" data-tag="boltzmann machines">Boltzmann Machines</button>
                <button class="tag-btn" data-tag="shape recognition">Shape Recognition</button>
                <button class="tag-btn" data-tag="review papers">Review Papers</button>
                <button class="tag-btn" data-tag="backpropagation">Backpropagation</button>
                <button class="tag-btn" data-tag="speech">Speech</button>
                <button class="tag-btn" data-tag="evolution">Evolution</button>
                <button class="tag-btn" data-tag="mixture of experts">Mixture of Experts</button>
                <button class="tag-btn" data-tag="distributed representations">Distributed Representations</button>
                <button class="tag-btn" data-tag="motor control">Motor Control</button>
                <button class="tag-btn" data-tag="helmholtz machines">Helmholtz Machines</button>
                <button class="tag-btn" data-tag="brain damage">Brain Damage</button>
                <button class="tag-btn" data-tag="mental imagery">Mental Imagery</button>
                <button class="tag-btn" data-tag="neural belief nets">Neural Belief Nets</button>
                <button class="tag-btn" data-tag="other nn learning algorithms">Other NN Learning Algorithms</button>
                <button class="tag-btn" data-tag="tropical archaeoastronomy">Tropical Archaeoastronomy</button>
                <button class="tag-btn" data-tag="oddities">Other Oddities</button>
            </div>
        </div>


        <!-- Template for programmatic publication rendering -->
        <template id="publication-template">
            <div class="publication-item" data-tags="">
                <div class="publication-authors"></div>
                <div class="publication-title"></div>
                <a class="publication-venue" href="#"></a>
            </div>
        </template>

        <div class="container publications-container" id="publications-root">
            <!-- Publications will be rendered here from `pages/publications.json` -->
        </div>
    </main>

    <!-- Year Scrubber -->
    <div class="year-scrubber">
        <div class="year-markers"></div>
        <div class="scrubber-track">
            <div class="scrubber-handle" id="scrubber-handle"></div>
        </div>
        <div class="scrubber-label" id="scrubber-label">2022</div>
    </div>

    <script>
            // Dynamic rendering: fetch publications JSON, render years and items,
            // build tag filters, and initialize the scrubber against generated sections.
            (function() {
                const scrubberTrack = document.querySelector('.scrubber-track');
                const scrubberHandle = document.getElementById('scrubber-handle');
                const scrubberLabel = document.getElementById('scrubber-label');
                const yearMarkers = document.querySelector('.year-markers');

                let isDragging = false;
                let trackHeight = 0;

                let years = []; // populated after rendering
                let minYear = null;
                let maxYear = null;
                let yearRange = 0;

                const tpl = document.getElementById('publication-template');

                function renderPublication(container, pub) {
                    if (!tpl) return null;
                    const clone = tpl.content.firstElementChild.cloneNode(true);
                    const tagsAttr = Array.isArray(pub.tags) ? pub.tags.join(', ') : (pub.tags || '');
                    if (tagsAttr) clone.setAttribute('data-tags', tagsAttr);
                    clone.querySelector('.publication-authors').textContent = pub.authors || '';
                    clone.querySelector('.publication-title').textContent = pub.title || '';
                    const a = clone.querySelector('.publication-venue');
                    a.textContent = pub.venue || '';
                    if (pub.href) a.setAttribute('href', pub.href);
                    container.appendChild(clone);
                    return clone;
                }

                function createYearSection(root, year) {
                    const section = document.createElement('div');
                    section.className = 'year-section';
                    section.id = `year-${year}`;

                    const header = document.createElement('div');
                    header.className = 'year-header';
                    header.innerHTML = `<h2 class="h3 mb-0">${year}</h2>`;
                    section.appendChild(header);

                    const list = document.createElement('div');
                    list.id = `year-${year}-list`;
                    section.appendChild(list);

                    root.appendChild(section);
                    return list;
                }

                function buildTagFilter(tagSet) {
                    const filterContainer = document.querySelector('.tag-filter');
                    if (!filterContainer) return;
                    // keep the label span if exists
                    const label = filterContainer.querySelector('.filter-label');
                    filterContainer.innerHTML = '';
                    if (label) filterContainer.appendChild(label);

                    // Create an "All" button
                    const allBtn = document.createElement('button');
                    allBtn.className = 'tag-btn active';
                    allBtn.textContent = 'All';
                    allBtn.dataset.tag = '__all';
                    filterContainer.appendChild(allBtn);

                    Array.from(tagSet).sort().forEach(tag => {
                        const btn = document.createElement('button');
                        btn.className = 'tag-btn';
                        btn.dataset.tag = tag;
                        btn.textContent = tag[0].toUpperCase() + tag.slice(1);
                        filterContainer.appendChild(btn);
                    });
                }

                function getRenderedPublications() {
                    return Array.from(document.querySelectorAll('.publication-item'));
                }

                function applyFilter(activeTags) {
                    const publications = getRenderedPublications();
                    if (activeTags.size === 0 || activeTags.has('__all')) {
                        publications.forEach(p => p.style.display = 'block');
                        return;
                    }

                    publications.forEach(publication => {
                        const tags = (publication.getAttribute('data-tags') || '').split(',').map(t => t.trim()).filter(Boolean);
                        const matches = Array.from(activeTags).some(tag => tags.includes(tag));
                        publication.style.display = matches ? 'block' : 'none';
                    });
                }

                function attachFilterListeners() {
                    const filterContainer = document.querySelector('.tag-filter');
                    if (!filterContainer) return;
                    let activeTags = new Set(['__all']);

                    filterContainer.addEventListener('click', function(e) {
                        const btn = e.target.closest('.tag-btn');
                        if (!btn) return;
                        const tag = btn.dataset.tag;

                        // Toggle behavior
                        if (tag === '__all') {
                            // Clear other selections
                            activeTags = new Set(['__all']);
                            // Update UI
                            filterContainer.querySelectorAll('.tag-btn').forEach(b => b.classList.remove('active'));
                            btn.classList.add('active');
                        } else {
                            // deselect 'All'
                            activeTags.delete('__all');
                            const allBtn = filterContainer.querySelector('[data-tag="__all"]');
                            if (allBtn) allBtn.classList.remove('active');

                            if (activeTags.has(tag)) {
                                activeTags.delete(tag);
                                btn.classList.remove('active');
                            } else {
                                activeTags.add(tag);
                                btn.classList.add('active');
                            }

                            // if none selected, revert to All
                            if (activeTags.size === 0) {
                                activeTags.add('__all');
                                if (allBtn) allBtn.classList.add('active');
                            }
                        }

                        applyFilter(activeTags);
                    });
                }

                // --- Scrubber logic (uses generated year sections) ---
                function createYearMarkers() {
                    yearMarkers.innerHTML = '';
                    if (!years.length || yearRange === 0) return;
                    years.forEach(year => {
                        const marker = document.createElement('div');
                        marker.className = 'year-marker';
                        if (year % 10 === 0) marker.classList.add('major');
                        const position = ((maxYear - year) / yearRange) * 100;
                        marker.style.top = `${position}%`;
                        yearMarkers.appendChild(marker);
                    });
                }

                function getYearFromPosition(position) {
                    const percentage = position / trackHeight;
                    const year = Math.round(maxYear - (percentage * yearRange));
                    return Math.max(minYear, Math.min(maxYear, year));
                }

                function getPositionFromYear(year) {
                    const percentage = (maxYear - year) / yearRange;
                    return percentage * trackHeight;
                }

                function updateHandlePosition(year) {
                    const position = getPositionFromYear(year);
                    scrubberHandle.style.top = `${position}px`;
                    scrubberLabel.textContent = year;
                    const yearSection = document.getElementById(`year-${year}`);
                    if (yearSection) yearSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }

                function handleStart(e) {
                    isDragging = true;
                    scrubberLabel.classList.add('active');
                    document.body.style.userSelect = 'none';
                    const rect = scrubberTrack.getBoundingClientRect();
                    const clientY = e.type.includes('touch') ? e.touches[0].clientY : e.clientY;
                    const position = clientY - rect.top;
                    const year = getYearFromPosition(position);
                    updateHandlePosition(year);
                }

                function handleMove(e) {
                    if (!isDragging) return;
                    e.preventDefault();
                    const rect = scrubberTrack.getBoundingClientRect();
                    const clientY = e.type.includes('touch') ? e.touches[0].clientY : e.clientY;
                    const position = Math.max(0, Math.min(trackHeight, clientY - rect.top));
                    const year = getYearFromPosition(position);
                    updateHandlePosition(year);
                }

                function handleEnd() {
                    isDragging = false;
                    scrubberLabel.classList.remove('active');
                    document.body.style.userSelect = '';
                }

                // Intersection observer to update scrubber while scrolling
                const observer = new IntersectionObserver(function(entries) {
                    if (isDragging) return;
                    entries.forEach(entry => {
                        if (entry.isIntersecting && entry.intersectionRatio > 0.5) {
                            const year = parseInt(entry.target.id.replace('year-', ''));
                            const position = getPositionFromYear(year);
                            scrubberHandle.style.top = `${position}px`;
                            scrubberLabel.textContent = year;
                        }
                    });
                }, { threshold: [0.5], rootMargin: '-100px 0px -100px 0px' });

                function initScrubber() {
                    trackHeight = scrubberTrack.offsetHeight;
                    createYearMarkers();
                    if (years.length) updateHandlePosition(maxYear);
                    // observe sections
                    document.querySelectorAll('.year-section').forEach(sec => observer.observe(sec));

                    // event listeners
                    scrubberHandle.addEventListener('mousedown', handleStart);
                    scrubberHandle.addEventListener('touchstart', handleStart, { passive: false });
                    document.addEventListener('mousemove', handleMove);
                    document.addEventListener('touchmove', handleMove, { passive: false });
                    document.addEventListener('mouseup', handleEnd);
                    document.addEventListener('touchend', handleEnd);
                    scrubberTrack.addEventListener('click', function(e) {
                        if (e.target === scrubberHandle) return;
                        const rect = scrubberTrack.getBoundingClientRect();
                        const position = e.clientY - rect.top;
                        const year = getYearFromPosition(position);
                        updateHandlePosition(year);
                    });

                    window.addEventListener('resize', function() { setTimeout(() => { trackHeight = scrubberTrack.offsetHeight; createYearMarkers(); }, 150); });
                }

                // --- Fetch JSON and render everything ---
                function renderAll(data) {
                    const root = document.getElementById('publications-root');
                    root.innerHTML = '';

                    const tagSet = new Set();
                    const yearKeys = Object.keys(data).map(y => parseInt(y, 10)).filter(Boolean).sort((a,b) => b - a);

                    yearKeys.forEach(year => {
                        const pubs = data[year] || [];
                        if (!pubs.length) return;
                        const list = createYearSection(root, year);
                        pubs.forEach(pub => {
                            renderPublication(list, pub);
                            const tags = Array.isArray(pub.tags) ? pub.tags : (pub.tags ? pub.tags.split(',').map(t=>t.trim()) : []);
                            tags.forEach(t => { if (t) tagSet.add(t); });
                        });
                    });

                    // populate variables for scrubber
                    years = yearKeys;
                    if (years.length) {
                        maxYear = Math.max(...years);
                        minYear = Math.min(...years);
                        yearRange = maxYear - minYear || 1;
                    }

                    buildTagFilter(tagSet);
                    attachFilterListeners();
                    initScrubber();
                }

                // load JSON (relative to this HTML file -> publications.json in same folder)
                fetch('publications.json')
                    .then(r => {
                        if (!r.ok) throw new Error('Failed to load publications.json');
                        return r.json();
                    })
                    .then(data => renderAll(data))
                    .catch(err => {
                        console.error('Could not load publications.json:', err);
                        // As a fallback, you could render a minimal message
                        const root = document.getElementById('publications-root');
                        if (root) root.innerHTML = '<p class="text-muted">Could not load publications data.</p>';
                    });
            })();
    </script>
</body>
</html>